<app-page-subtitle [subtitle]="'New File'"></app-page-subtitle>
<!-- Body -->
<grid-main [class]="'fmxw-800'" [centered]="true">
  <div *ngIf="isLoading" style="text-align: center;">
    <app-loading-spinner></app-loading-spinner>
  </div>

  <div class="files files-effect-scale files-theme boxtest">
    <input type="radio" name="files" checked  id="tab1" class="tab-content-first" (change)='souceType("import")'>
    <label for="tab1"><fa-icon [icon]="faUpload" aria-hidden="true"></fa-icon> Upload Files</label>

    <input type="radio" name="files" id="tab2" class="tab-content-2" (change)='souceType("inline")'>
    <label for="tab2"><fa-icon [icon]="faDownload" aria-hidden="true"></fa-icon> Download URL</label>
    <ul>
      <li class="tab-content tab-content-first" >
        <div class="row" >
          <form [formGroup]="createForm" (ngSubmit)="onSubmit()">
          <div class="col-sm">
            <div class="form-group">
              <label class="form-label display-col requiredak" for="Associatedg">Associated Access Group</label>
              <select
                      type="number"
                      class='form-select'
                      formControlName="accessGroupId"
                      >
                <option *ngFor="let a of accessgroup" [ngValue]="a.accessGroupId">{{ a.groupName }}</option>
              </select>
            </div>
          </div>
          &nbsp;
            <tr id="uploadLine">
              <div>
                <input
                      type="file"
                      accept="/*"
                      formControlName="sourceData"
                      (change)="handleFileInput($event)"
                      fileSelect directory #file
                >
                <span style="width: 100%;text-align: center" class="fileuploadspan"></span>&nbsp;
                <span style="width: 50%;text-align: center"><fa-icon [icon]="faFileUpload" class="btn btn-gray-800" title="Upload file" (click)="onuploadFile(file.files);" aria-hidden="true"></fa-icon></span>
              </div>
              <div *ngFor="let fileStatus of uploadProgress | async">
                    &nbsp;
                  <p *ngIf="fileStatus.progress !== 100">Uploading File: {{fileStatus.filename}}</p>
                  <ngb-progressbar
                                  type="success"
                                  textType="white"
                                  [striped]="true"
                                  [value]="fileStatus.progress"
                                  [showValue]="true"
                  ></ngb-progressbar>
                  <!-- <p>Progress: {{fileStatus.progress}}%</p> -->
                  <div *ngIf="fileStatus.progress === 100">
                    <p><b>File Uploaded</b></p>
                  </div>
              </div>
            </tr>
            &nbsp;

            <div class="col-sm">
              <button-submit [name]="'Create'"></button-submit>
            </div>
        </form>
        </div>
      </li>

      <li class="tab-content tab-content-2">
        <div class="row">
          <form [formGroup]="createForm" (ngSubmit)="onSubmit()">
          <div class="row g-3">
            <div class="col-md-6">
              <div class="form-group">
                <label class="form-label display-col requiredak" for="setName">Name</label>
                <input
                        type='text'
                        id="filename"
                        class='form-control'
                        formControlName="filename"
                >
              </div>
            </div>
            <div class="col-md-6">
            <div class="form-group">
              <label class="form-label display-col requiredak" for="Associatedg">Associated Access Group</label>
              <select
                      type='number'
                      id="accessgroup"
                      class='form-select'
                      formControlName="accessGroupId"
              >
                <!-- <option [defaultSelected]=true>---</option> -->
                <option *ngFor="let a of accessgroup" [ngValue]="a.accessGroupId">{{ a.groupName }}</option>
              </select>
            </div>
            </div>
          </div>
          &nbsp;
          <div class="col-sm">
            <div class="mb-3">
                <label for="secret" class="display-col">Download URL</label>
                <div class="input-group">
                    <span class="input-group-text">
                      <fa-icon [icon]="faLink" aria-hidden="true"></fa-icon>
                    </span>
                    <input
                          class='form-control'
                          formControlName="sourceData"
                          pattern="^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$"
                          required
                      >
                </div>
            </div>
          </div>
          <div class="col-sm">
            <button-submit [name]="'Create'"></button-submit>
          </div>
        </form>
        </div>
      </li>

    </ul>
  </div>
</grid-main>
