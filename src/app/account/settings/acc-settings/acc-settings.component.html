<app-table>
  <app-page-title [title]="pageTitle"></app-page-title>
  <br /><br />
  <form [formGroup]="form">
    <div fxLayout="row wrap" fxLayoutAlign="start center" fxLayoutGap="10px">
      <input-text title="Account Type" formControlName="name" data-testid="input-name"></input-text>
      <input-text
        title="Creation date"
        formControlName="registeredSince"
        data-testid="input-registered-since"
      ></input-text>
    </div>
    <input-text email inputType="email" title="Email" formControlName="email" [isRequired]="true" data-testid="input-email"></input-text>
    <grid-buttons>
      <button-submit [name]="'Update'" (click)="onSubmit()" [disabled]="form.invalid || form.pending" data-testid="button-update-submit"></button-submit>
      <div *ngIf="isUpdatingLoading">
        <mat-spinner diameter="24" color="accent"></mat-spinner>
      </div>
    </grid-buttons>
  </form>

  <br />
  <app-page-subtitle [subtitle]="pageSubtitlePassword"></app-page-subtitle>
  <form [formGroup]="changepasswordFormGroup" style="display: flex; flex-direction: column; gap: 0.625rem">
    <input-text
      title="Old Password"
      formControlName="oldPassword"
      [inputType]="showOldPassword ? 'text' : 'password'"
      data-testid="input-oldPassword"
      [isRequired]="true"
      [showPasswordToggle]="true"
      [passwordIsVisible]="showOldPassword"
      (ShowPasswordEmit)="showOldPassword = $event"
    ></input-text>
    <input-text
      title="New Password"
      formControlName="newPassword"
      [inputType]="showNewPassword ? 'text' : 'password'"
      data-testid="input-newPassword"
      [isRequired]="true"
      [minLength]="pwdMin"
      [maxLength]="pwdMax"
      [showPasswordToggle]="true"
      [passwordIsVisible]="showNewPassword"
      (ShowPasswordEmit)="showNewPassword = $event"
    ></input-text>

    <input-text
      title="Confirm New Password"
      formControlName="confirmNewPassword"
      [inputType]="showConfirmNewPassword ? 'text' : 'password'"
      data-testid="input-confirmNewPassword"
      [isRequired]="true"
      [minLength]="pwdMin"
      [maxLength]="pwdMax"
      [passwordIsVisible]="showConfirmNewPassword"
      [showPasswordToggle]="true"
      (ShowPasswordEmit)="showConfirmNewPassword = $event"
    ></input-text>
    <div class="smaller-pass-strength">
      <app-pass-strenght [passwordToCheck]="newPasswordValueFromForm"></app-pass-strenght>
    </div>

    <mat-error *ngIf="changepasswordFormGroup.hasError('passwordMismatch') && changepasswordFormGroup.touched">
      Passwords do not match
    </mat-error>

    <grid-buttons>
      <button-submit [name]="'Update Password'" (click)="onSubmitPass()" [disabled]="changepasswordFormGroup.invalid || changepasswordFormGroup.pending" data-testid="button-password-submit"></button-submit>
      <div *ngIf="isUpdatingPassLoading">
        <mat-spinner diameter="24" color="accent"></mat-spinner>
      </div>
    </grid-buttons>
  </form>
</app-table>
